global:
  username: rainbow-dango
  project_name: hcmus-fsd
  run_name: double-vit224-newdataset
  save_dir: logs
  SEED: 47
  resume: null
dataset:
  name: FaceSpoofingDataset
  transform:
    train: train_classify_replay_tf
    val: test_classify_tf
    test: test_classify_tf
  args:
    train:
      source_path: fsd-deepfakerapp/dfapp_plus/train/
      split_file: all.csv
      oversampling: True
    val:
      source_path: fsd-deepfakerapp/dfapp_plus/test/
      split_file: all.csv
      oversampling: False
    test:
      source_path: fsd-deepfakerapp/dfapp_plus/test/
      split_file: all.csv
      oversampling: False
data_loader:
  train:
    args:
      batch_size: 32
      num_workers: 8
      shuffle: True
  val:
    args:
      batch_size: 32
      num_workers: 8
      shuffle: False
  test:
    args:
      batch_size: 32
      num_workers: 8
      shuffle: False
model:
  name: DoubleHeadFrameClassifier
  input_size: 224
  num_classes: 2
  extractor:
    img_encoder:
      name: VitNetExtractor
      args:
        version: vit_base_patch16_224
        from_pretrained: True
        freeze: False
    img_variant_encoder:
      name: VitNetExtractor
      args:
        version: vit_base_patch16_224
        from_pretrained: True
        freeze: False
metric:
  - name: Accuracy
    args:
  - name: BinaryEqualErrorRate
    args:
trainer:
  num_worker: 8
  start_epoch: 0
  start_epoch: 0
  num_epochs: 100
  evaluate_interval: 1
  log_interval: 20
  use_fp16: True
  debug: False
optimizer:
  lr: 0.0001
lr_scheduler:
  name: ReduceLROnPlateau
  args:
    mode: min
    factor: 0.5
    patience: 3
    min_lr: 0.00001
  monitor: val/loss
callbacks:
  - name: ModelCheckpoint
    args:
      filename: "doubleVit224-epoch={epoch}-val_acc={val/accuracy:.4f}"
      monitor: "val/accuracy"
      verbose: True
      save_top_k: 3
      mode: max
      auto_insert_metric_name: False #https://github.com/Lightning-AI/lightning/issues/4012
  - name: EarlyStopping
    args:
      monitor: "val/loss"
      min_delta: 0.0001
      patience: 15
      verbose: False
      mode: min
  - name: LearningRateMonitor
    args:
      logging_interval: step
      



